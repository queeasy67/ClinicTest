// --- ‚öôÔ∏è UPDATED CONFIG STATE & TRANSLATIONS ---
const [config, setConfig] = React.useState({
    // ... previous fields
    lang: 'en',
    templateEn: "Number {number}, please proceed to {room}",
    templateMs: "Nombor {number}, sila ke {room}",
    greetingEn: "Welcome to our clinic.",
    greetingMs: "Selamat datang ke klinik kami.",
    voiceSpeed: 0.9
});

const TRANSLATIONS = {
    en: { call: "CALL", done: "DONE", settings: "Settings", templateLabel: "EN Announcement Template" },
    ms: { call: "PANGGIL", done: "SELESAI", settings: "Tetapan", templateLabel: "Templat Pengumuman BM" }
};

// --- üîä SMART BILINGUAL VOICE LOGIC ---
const announceTicket = (num, room) => {
    if (!audioUnlocked) return;

    // Helper to replace placeholders
    const parse = (template, n, r) => template.replace('{number}', n).replace('{room}', r.replace('Room', ''));

    const speak = (text, langCode, onEnd) => {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = langCode;
        utterance.rate = config.voiceSpeed || 0.9;
        utterance.onend = onEnd;
        window.speechSynthesis.speak(utterance);
    };

    chime.play().then(() => {
        // First: English Greeting + Pattern
        const textEn = `${config.greetingEn} ${parse(config.templateEn, num, room)}`;
        speak(textEn, 'en-US', () => {
            // Second: Malay Greeting + Pattern (Starts after English ends)
            const textMs = `${config.greetingMs} ${parse(config.templateMs, num, room)}`;
            setTimeout(() => speak(textMs, 'ms-MY'), 500);
        });
    });
};

// --- üõ†Ô∏è UPDATED SETTINGS MODAL (ADD THESE FIELDS) ---
/* Inside your Settings Modal JSX, add these inputs: */
<div className="grid grid-cols-2 gap-4">
    <div>
        <label className="text-[10px] font-bold text-slate-400 uppercase">English Template</label>
        <input 
            value={config.templateEn} 
            onChange={e => setConfig({...config, templateEn: e.target.value})} 
            placeholder="Ex: Number {number} to {room}"
            className="w-full p-3 rounded-xl bg-slate-50 border mt-1 font-medium"
        />
    </div>
    <div>
        <label className="text-[10px] font-bold text-slate-400 uppercase">Malay Template (BM)</label>
        <input 
            value={config.templateMs} 
            onChange={e => setConfig({...config, templateMs: e.target.value})} 
            placeholder="Cth: Nombor {number} ke {room}"
            className="w-full p-3 rounded-xl bg-slate-50 border mt-1 font-medium"
        />
    </div>
</div>
<p className="text-[9px] text-blue-500 font-bold mt-1 italic">Use {`{number}`} and {`{room}`} as placeholders.</p>
